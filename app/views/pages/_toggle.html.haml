%img{:src=>"/assets/seta_d.png", :id=>"togglao", :fechado=>"1"}	

:coffeescript
	
	abre = (id) ->
		seta = $(id)
		$(seta.attr("toggle")).parent().slideToggle()		
		if seta.attr("fechado") == "0"
			seta.attr("fechado", "1")
			seta.rotate({animateTo:90})
		else
			seta.attr("fechado", "0")
			seta.rotate({animateTo:0})

	trocar = (x, y) ->
		src = $("#togglao").attr("src").replace(x, y)
		$("#togglao").attr("src", src)		

	$ ->
		$("body").css "overflow", "hidden"	
		$("#menu").css "margin-bottom", "30px"	
		$("#menu").css("float", "left")
		
		$(".abre").click -> abre($(this))
		$(".item").click -> abre($(this).next().children())

		$("#togglao").hover(
			-> trocar "seta_d", "seta_d2"
			-> trocar "seta_d2", "seta_d"								
		).click -> 		
			$("#lateral").animate({width: 'toggle'})
			seta = $("#togglao")			
			if seta.attr("fechado")=="1"
				seta.attr("fechado", "0")
				seta.rotate({animateTo:-180})
			else
				seta.attr("fechado", "1")
				seta.rotate({animateTo:0})

		$(window).resize ->
			seta = $("#togglao")
			metade = ($(window).height()/2 - seta.height()/2 -30)
			seta.css("top", metade)
			$('#lateral').css("height", $(window).height())
			$('#togglao').css("left", $(window).width()-40)

		$("#togglao").load -> $(window).resize()